<html>
    <head>
        <title>SoccerNoid</title>
        <script type="text/javascript" language="javascript" src="/SoccerNoid/sources/javascript/mainGame.js"></script>
        <link rel="stylesheet" type="text/css" href="/SoccerNoid/sources/css/main.css">
    </head>
    <body>
        <div class="gameHeader">

        </div>
        <div class="gameLeft">

        </div>
        <div id="cnt" class="gameGround">

            <canvas id= "ourPlayground"  > </canvas>
           
            <script>
            var canvas = document.getElementById("ourPlayground");
            var ctx = canvas.getContext("2d");
            var container = document.getElementById("cnt");
            canvas.width = container.offsetWidth;
            canvas.height = container.offsetHeight;
            var paddleHeight = 10;
            var paddleWidth = 60;
            var paddleX = 300;
            var paddleY = canvas.height * 0.85;
            var ballRadius = 10;
            var ballX = canvas.width/2;
            var ballY = canvas.height/2;
            var score = 0;
            var lives = 3;
            var directionX = 1;
            var directionY = 1;
            var rightPressed = false;
            var leftPressed = false;
            var keyboardX = 0;

             
            draw();
            document.addEventListener("mousemove", mouseMoveHandler, false);
            document.addEventListener("keydown", keyDownHandler, false);
            document.addEventListener("keyup", keyUpHandler, false);

            function keyDownHandler(e){
                if(e.keyCode == 39){
                    rightPressed == true; 
                    paddleX = paddleX + 20;
                }
                else if(e.keyCode == 37){
                    leftPressed == true; 
                    paddleX = paddleX - 20;
                }
            }

            function keyUpHandler(e){
                if(e.keyCode == 39){
                    rightPressed == false;
                }
                else if(e.keyCode == 37){
                    leftPressed == false;
                }
            }

            function mouseMoveHandler(e) {
            var positionX = e.clientX - canvas.offsetLeft - paddleWidth/2;
            if(positionX > 0 && positionX < canvas.width) {
                    paddleX = positionX ; 
            }
                 if(positionX < 0){
                    paddleX = 0 ;
            }
                if(positionX + paddleWidth > canvas.width){
                    paddleX = canvas.width -paddleWidth;
            }
            }

            function drawScore() {
             ctx.font = "16px Arial";
             ctx.fillStyle = "darkgreen";
             ctx.fillText("Score: "+score, 20, 13);
            }

            function drawLives() {
             ctx.font = "16px Arial";
             ctx.fillStyle = "darkgreen";
             ctx.fillText("Lives: "+lives, canvas.width-75, 13);
            }
           function drawPaddle(){
            
               ctx.beginPath();
               ctx.rect(paddleX + keyboardX, paddleY, paddleWidth, paddleHeight);
               ctx.fillStyle = "darkgreen";
               ctx.fill();
               ctx.closePath();
              
           }
           
           function drawBall(){
               ctx.beginPath();
               ctx.arc(ballX, ballY, ballRadius, 0, Math.PI*2);
               ctx.fillStyle = "darkgreen";
               ctx.fill();
               ctx.closePath();   
               moveBall();              
           }

           function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawPaddle();
            drawBall();
            drawScore();
            drawLives();
            
            setTimeout(draw,40);
           }

           function moveBall(){
            ballX += 5 * directionX;
            ballY += 5 * directionY;
            if(ballX + ballRadius >= canvas.width || ballX -ballRadius <= 0){
            directionX *= -1;
        }
            if( ballY - ballRadius <= 0 ){
            directionY *= -1;
        }
            if(ballY + ballRadius >= paddleY && ballY - ballRadius <= paddleY + paddleHeight && ballX - ballRadius >= paddleX  && ballX + ballRadius <= paddleX + paddleWidth){
                directionY *= -1;
            } 
            else if(ballX + ballRadius >= paddleX && ballX - ballRadius <= paddleX + paddleWidth && ballY - ballRadius <= paddleY + paddleHeight && ballY + ballRadius >= paddleY){
                directionX *= -1;
            }
            else if(ballY + ballRadius >= canvas.height){
                lives --;
                ballX = canvas.width/2;
                ballY = canvas.height/2;
                if(lives == 0){
                    window.location.href = "/SoccerNoid/sources/gameOver.html";
                }
            }
           }

          
           

            
            </script>
        
        </div>
        <div class="gameScore" id="scoreboard">
        
        </div>
        <div class="gameFooter">
        
        </div>
    </body>
</html>